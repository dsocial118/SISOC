{% extends "includes/main.html" %}
{% load static custom_filters %}
{% block head %}
    {{ block.super }}
    <link rel="stylesheet"
          href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" />
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/charts.css/dist/charts.min.css" />
    <link rel="stylesheet" href="{% static 'custom/css/dashboard.css' %}" />
{% endblock %}
{% block title %}Dashboard{% endblock %}
{% block titulo-pagina %}Dashboard{% endblock %}
{% block breadcrumb %}{% endblock %}
{% block menu-adicional %}{% endblock %}
{% block content %}
    {# Bloque SSE: sólo indicadores nuevos #}
    {% if request.user|has_group:"Dashboard Centrodefamilia" %}
        <div class="row mb-4">
            <!-- Participantes Totales -->
            <div class="col-3">
                <div style="display:flex;
                            overflow:hidden;
                            border-radius:0.75rem;
                            box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                    <!-- Icono: oscuro -->
                    <div style="flex:0 0 4rem;
                                background:#D3A141;
                                display:flex;
                                align-items:center;
                                justify-content:center">
                        <i class="fas fa-user-friends" style="font-size:1.5rem; color:#fff;"></i>
                    </div>
                    <!-- Contenido: claro -->
                    <div style="flex:1;
                                background:#FCD280;
                                color:#fff;
                                padding:0.75rem 1.5rem">
                        <div style="font-size:2rem; font-weight:600; line-height:1;">{{ participantes_total }}</div>
                        <div style="font-size:1rem; opacity:0.9;">Participantes Totales</div>
                    </div>
                </div>
            </div>
            <!-- Centros Adheridos -->
            <div class="col-3">
                <div style="display:flex;
                            overflow:hidden;
                            border-radius:0.75rem;
                            box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                    <!-- Icono: oscuro -->
                    <div style="flex:0 0 4rem;
                                background:#5C86AD;
                                display:flex;
                                align-items:center;
                                justify-content:center">
                        <i class="fas fa-building" style="font-size:1.5rem; color:#fff;"></i>
                    </div>
                    <!-- Contenido: claro -->
                    <div style="flex:1;
                                background:#96C5F1;
                                color:#fff;
                                padding:0.75rem 1.5rem">
                        <div style="font-size:2rem; font-weight:600; line-height:1;">{{ centros_adheridos_totales }}</div>
                        <div style="font-size:1rem; opacity:0.9;">Centros Adheridos</div>
                    </div>
                </div>
            </div>
            <!-- Centros Faro -->
            <div class="col-3">
                <div style="display:flex;
                            overflow:hidden;
                            border-radius:0.75rem;
                            box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                    <!-- Icono: oscuro -->
                    <div style="flex:0 0 4rem;
                                background:#D17C94;
                                display:flex;
                                align-items:center;
                                justify-content:center">
                        <i class="fas fa-lightbulb" style="font-size:1.5rem; color:#fff;"></i>
                    </div>
                    <!-- Contenido: claro -->
                    <div style="flex:1;
                                background:#FCC8D7;
                                color:#fff;
                                padding:0.75rem 1.5rem">
                        <div style="font-size:2rem; font-weight:600; line-height:1;">{{ centros_faro_totales }}</div>
                        <div style="font-size:1rem; opacity:0.9;">Centros Faro</div>
                    </div>
                </div>
            </div>
            <!-- Actividades Totales -->
            <div class="col-3">
                <div style="display:flex;
                            overflow:hidden;
                            border-radius:0.75rem;
                            box-shadow:0 4px 6px rgba(0,0,0,0.1)">
                    <!-- Icono: oscuro -->
                    <div style="flex:0 0 4rem;
                                background:#C84542;
                                display:flex;
                                align-items:center;
                                justify-content:center">
                        <i class="fas fa-tasks" style="font-size:1.5rem; color:#fff;"></i>
                    </div>
                    <!-- Contenido: claro -->
                    <div style="flex:1;
                                background:#FE807E;
                                color:#fff;
                                padding:0.75rem 1.5rem">
                        <div style="font-size:2rem; font-weight:600; line-height:1;">{{ actividades_totales }}</div>
                        <div style="font-size:1rem; opacity:0.9;">Actividades Totales</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="container">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Datos de Centro De Familia</h3>
                        <div class="card-tools">
                            <button type="button" class="btn btn-tool" data-card-widget="collapse">
                                <i class="fas fa-minus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="row">

                            <div class="col-12">
                                <div class="position-relative" style="padding-top:56.25%;">
                                    <iframe title="Centros de Familia - Seguimiento del programa v3"
                                            src="https://app.powerbi.com/view?r=eyJrIjoiOTMyNjY2ZjQtY2FhZC00NGRlLTg0NjUtNDFlNWQ5MGMwNjVlIiwidCI6IjRmODIyY2Y0LTY4NjctNDNmYS1hZTRhLTAzYTM5ZmU5MzA5YyIsImMiOjR9"
                                            frameborder="0"
                                            allowfullscreen
                                            style="position:absolute; top:0; left:0; width:100%; height:100%; border:0; min-height:75vh;">
                                    </iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% elif request.user|has_group:"Dashboard Comedor" %}
    <div class="row mb-4">
        <div class="col-4">
            <div class="custom-card card-violet">
                <div class="card-icon">
                    <i class="fas fa-utensils"></i>
                </div>
                <div class="card-content">
                    <div class="card-amount">{{ cantidad_comedores_activos }}</div>
                    <div class="card-title">Comedores Activos</div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <div class="custom-card card-red">
                <div class="card-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="card-content">
                    <div class="card-amount">{{ cantidad_relevamientos_activos }}</div>
                    <div class="card-title">Relevamientos Activos</div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <div class="custom-card card-green">
                <div class="card-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="card-content">
                    <div class="card-amount">0</div>
                    <div class="card-title">Beneficiarios</div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-9">
            <div class="embed-responsive embed-responsive-16by9 w-100">
                <iframe class="embed-responsive-item"
                        title="Tablero - Comedores"
                        src="https://app.powerbi.com/reportEmbed?reportId=35d6f754-ce1d-48b8-a463-3ba9f3ac6d70&autoAuth=true&ctid=4f822cf4-6867-43fa-ae4a-03a39fe9309c"
                        allowfullscreen></iframe>
            </div>
        </div>
        <div class="col-md-3">
            <div class="custom-card mb-2">
                <div class="card-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="card-content">
                    <div class="card-title">Duplas</div>
                    <div class="card-amount">{{ presupuesto_desayuno }}</div>
                </div>
            </div>
            <div class="custom-card mb-2">
                <div class="card-icon">
                    <i class="fas fa-coffee"></i>
                </div>
                <div class="card-content">
                    <div class="card-title">Presupuesto Desayuno</div>
                    <div class="card-amount">${{ presupuesto_desayuno }}</div>
                </div>
            </div>
            <div class="custom-card mb-2">
                <div class="card-icon">
                    <i class="fas fa-cookie"></i>
                </div>
                <div class="card-content">
                    <div class="card-title">Presupuesto Merienda</div>
                    <div class="card-amount">${{ presupuesto_merienda }}</div>
                </div>
            </div>
            <div class="custom-card mb-2">
                <div class="card-icon">
                    <i class="fas fa-utensils"></i>
                </div>
                <div class="card-content">
                    <div class="card-title">Presupuesto Comida</div>
                    <div class="card-amount">${{ presupuesto_comida }}</div>
                </div>
            </div>
        </div>
    </div>
{% else %}
    <div class="d-flex justify-content-center align-items-center"
         style="height: 70vh">
        <img src="{% static 'custom/img/sisoc_logo.png' %}"
             class="img-fluid"
             alt="Capacitación Humano" />
    </div>
{% endif %}
{% endblock %}
